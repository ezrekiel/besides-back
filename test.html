<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Board</title>
    <style>
        /* Style simple pour la mise en page */
        .job-ad {
            border: 1px solid #ccc;
            padding: 10px;
            margin: 10px 0;
        }

        .full-details {
            display: none; /* Masquer les détails par défaut */
        }

        button {
            margin-top: 10px;
            padding: 5px 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="job-board">
        <!-- Exemple d'une annonce -->
        <div class="job-ad" data-id="1">
            <h3>Software Engineer</h3>
            <p>Short description of the job</p>
            <button class="learn-more">Learn more</button>

            <!-- Détails complets qui seront affichés dynamiquement -->
            <div class="full-details">
                <p><strong>Full description:</strong> <span class="full-description"></span></p>
                <p><strong>Wage:</strong> <span class="wage"></span></p>
                <p><strong>Location:</strong> <span class="location"></span></p>
                <p><strong>Company:</strong> <span class="company"></span></p>
            </div>
        </div>
    </div>

    <script src="scriptnode.js"></script>
    <script>
        // Ajouter un événement à chaque bouton "learn more"
        document.querySelectorAll('.learn-more').forEach(button => {
            button.addEventListener('click', function() {
                const jobAd = this.closest('.job-ad');
                const jobId = jobAd.getAttribute('data-id');
                const fullDetailsDiv = jobAd.querySelector('.full-details');

                // Vérifie si les détails sont déjà affichés
                if (fullDetailsDiv.style.display === 'none' || fullDetailsDiv.style.display === '') {
                    fetch(`http://127.0.0.1:3000/api/job/${jobId}`)
                        .then(response => {
                            if (!response.ok) {
                                throw new Error(`HTTP error! Status: ${response.status}`);
                            }
                            return response.json(); // Parse la réponse JSON
                        })
                        .then(data => {
                            // Remplir les informations dans le div
                            fullDetailsDiv.querySelector('.full-description').textContent = data.libelle || 'N/A';
                            fullDetailsDiv.querySelector('.wage').textContent = data.salary || 'N/A';
                            fullDetailsDiv.querySelector('.location').textContent = data.city || 'N/A';
                            fullDetailsDiv.querySelector('.company').textContent = data.companyName || 'N/A';

                            // Afficher les détails complets
                            fullDetailsDiv.style.display = 'block';
                        })
                        .catch(error => {
                            console.error('Fetch error:', error);  // Log l'erreur pour débogage
                            alert('An error occurred while fetching the job details.');
                        });
                } else {
                    // Cacher les détails si déjà affichés
                    fullDetailsDiv.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>

